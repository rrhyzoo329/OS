# Chapter03프로세스와스레드 [02.프로세스제어블록과문맥교환] 

<br>

### 프로세스제어블록과 문맥교환

1. 프로세스 제어 블록(PCB :Process Control Block)

-  프로세스 제어 블록의 구성
   ![그림2](https://user-images.githubusercontent.com/93310395/177494687-58c82de3-9b86-487b-ada0-32bb8a5b77aa.png)
   - 포인터 : 프로세스가 준비상태나 대기 상태일 경우에 큐로 운영이 되는데, 프로세스 제어 블록을 연결 시 큐로 구현하기 위해 포인터를 사용함
     
     ![그림3](https://user-images.githubusercontent.com/93310395/177504249-5f49d5d5-2d75-4509-8843-4a0bc7349487.png)
   
   - 프로세스 상태 : 프로세스의 현재 상태 
   - 프로세스 구분자 : 운영체제 내에 있는 여러 프로세스를 구별하기 위한 구분자 저장
   - 프로세스 카운터 : 다음에 실행될 명령어의 위치를 가리키는 프로그램 카운터 저장 
   - 프로세스 우선순위 : CPU 스케줄러가 준비 상태에 있는 프로세스 중 실행 상태로 옮겨야 할 프로세스를 선택할 때 프로세스의 우선순위를 기준으로 삼기 때문에 저장
   - 각종 레지스터 정보 : 프로세스가 실행 중에 사용했던 레지스터 정보(누산기(Accumulator), 색인 레지스터, 스택 포인터 등)들이 저장되며, 이전 실행할 때 사용했던 레지스터 값들을 저장해야 다음에 실행할 수 있기 때문에 보관
   - 메모리 관리 정보 : 프로세스가 메모리의 어디에 있는지 알아야 하기 때문에 메모리 위치 정보가 필요하고 메모리 보호를 위해 사용되는 경계 레지스터, 한계 레지스터 값 등을 저장
   - 할당된 자원 정보 : 프로세스를 실행하기 위해 사용되는 입출력 자원, 오픈 파일 등에 대한 정보, 어떤 프로세스가 파일을 오픈하여 작업한다고 했을 경우 파일에 대한 정보가 필요하기 때문에 저장 필요 
   - 계정 정보 : 계정 번호, CPU 할당 시간, CPU 사용 시간 등이 저장
   - PPID와 CCID : 부모 프로세스 구분자(Parent PID)와 자식 프로세스 구분자(Child PID) 정보도 저장

2. 문맥교환
-  문맥교환의 의미
   - 문맥교환(context switching) : CPU를 차지하던 프로세스가 나가고 새로운 프로세스를 받아들이는 작업을 말함
   - CPU에서 나가는 프로세스는 지금까지의 작업 내용을 저장 => 새로 들어오는 프로세스는 프로세스 제어 블록의 내용으로 CPU가 다시 세팅 => 두 프로세스의 프로세스 제어 블록을 교환 

![image](https://user-images.githubusercontent.com/93310395/177505677-3bdde0d8-bdeb-4d10-aeb5-a46a9b89ce5c.png)

일반적으로 한 프로세스의 타임 퀀텀이 지나면 발생하고, 인터럽트 걸렸을 때도 발생 ex) 메모리 공간 초과
이 때 인터럽트가 발생하여 현재 실행 중인 프로세스 제어 블록 저장 후 인터럽트 관리 프로세스를 실행 상태로 만든다. 인터럽트 관리 프로세스는 메모리 범위 넘어선 프로세스 강제종료 후 인터럽트 처리 마치는데, 이와 같이 인터럽트 처리 시에도 문맥교환 발생한다.


   

 
``` 